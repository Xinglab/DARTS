"""
Darts_DNN - Darts_build_feature
# make the sequence and RBP features for a given comparison
# Zijun Zhang
# 6.16.2017
# revised 7.1.2017: add a command-line argument parser
# revised 8.7.2017: change to use kallisto est.
"""

import os
import sys
import pandas as pd
import numpy as np
import h5py
from collections import defaultdict
import logging
logger = logging.getLogger('Darts_DNN.build_feature')

from Darts_DNN import Darts_rbpTable as _Darts_rbp
from Darts_DNN import Darts_kallisto2rsem as _Darts_kallisto2rsem


def read_sequence_feature(fn):
	if not os.path.isfile(fn):
		raise Exception('cis feature file not found: %s'%fn)
	data=pd.read_hdf(fn)
	return data


def read_sp_out(sp_fn, sig_only=False):
	if not os.path.isfile(sp_fn):
		raise Exception("Darts-flat result not found: %s"%sp_fn)
		return None
	data=pd.read_table(sp_fn)
	data.index = data.ID
	if sig_only:
		evt = np.asarray(data.ID[[i for i in range(data.shape[0]) if data.post_pr[i]>0.9 or data.post_pr[i]<0.1]])
		label = np.asarray([1 if data.loc[x,'post_pr']>0.9 else 0 for x in evt])
	else:
		evt = np.asarray(data.ID[[i for i in data.ID
			if not np.isnan(data.post_pr[i])]])
		label = np.asarray([data.loc[x,'post_pr'] for x in evt])
	metadata = np.array([[x, 'Control', 'HepG2-K562', '', data.I1[x], data.S1[x], data.I2[x], data.S2[x]] for x in evt], dtype=str).astype('|S60')
	return {'evt':evt, 'label':label, 'metadata':metadata}


def read_rbp_exp(rbp_fn):
	colnames = np.empty((1498*2), dtype='str').astype('|S30')
	rbp_exp_vec = np.empty((1498*2))
	with open(rbp_fn, 'r') as fin:
		idx = 0
		firstline = True
		for line in fin:
			if firstline:
				firstline=False
				continue
			ele = line.rstrip().split()
			colnames[idx] = 'KD_' + ele[0]
			colnames[idx+1498] = 'Con_' + ele[0]
			rbp_exp_vec[idx] = float(ele[1])
			rbp_exp_vec[idx+1498] = float(ele[2])
			idx += 1
	return colnames, rbp_exp_vec


def RBPexp_normalizer(rbp_exp_vec):
	#global RBPexp_absmax
	RBPexp_absmax = np.zeros((1498))
	#with open(rbp_max_fn, 'r') as fin:
	if 1:
		i=0
		#for line in fin:
		for line in rbp_max_str.split('\n'):
			try:
				RBPexp_absmax[i] = float(line.rstrip().split()[1])
			except:
				RBPexp_absmax[i] = float(line.rstrip())
			i+=1
	for i in range(len(RBPexp_absmax)):
		rbp_exp_vec[i] = np.max([-0.99, np.min([0.99,rbp_exp_vec[i]/RBPexp_absmax[i]]) ])
		rbp_exp_vec[i+len(RBPexp_absmax)] = np.min([0.99,rbp_exp_vec[i+len(RBPexp_absmax)]/RBPexp_absmax[i]])
	return rbp_exp_vec


def make_single_table(darts_flat_fn, cis_feature_fn, outdir, outfn):
	
	#### read in darts-flat output ####
	print(".. read darts-flat output")
	sp_out = read_sp_out(darts_flat_fn)
	
	#### read in rbp exp ####
	print(".. read rbp exp")
	rbp_txt = [x for x in os.listdir(outdir) if 'RBP_tpm' in x]
	if len(rbp_txt)>1: print("warning: more than one RBP_tpm detected in folder.")
	rbp_fn = os.path.join(outdir,rbp_txt[0])
	print(rbp_fn)
	colnames, rbp_exp_vec = read_rbp_exp(rbp_fn)
	rbp_exp_vec = RBPexp_normalizer(rbp_exp_vec)
	
	#### read in sequence features ####
	print(".. read sequence feature")
	seqFeature = read_sequence_feature(cis_feature_fn)
	colnames_2 = seqFeature.columns.values
	seqFeature_len = seqFeature.shape[1]
	colnames = np.concatenate([colnames_2, colnames])
	
	#### make the feature table ####
	print(".. make table")
	idx = [i for i in range(len(sp_out['evt'])) if sp_out['evt'][i] in seqFeature.index]
	Y = sp_out['label'][idx]
	metadata = sp_out['metadata'][idx]
	X = seqFeature.loc[[x for x in sp_out['evt'] if x in seqFeature.index]].as_matrix()	
	if X.shape[0]==0:
		raise Exception('no ID could be matched with cis- file; check your Darts-flat ID column or if you supplied the correct cis-feature file.')
	X = np.hstack([X, [rbp_exp_vec]*X.shape[0]])
	
	#### save feature table in h5 ####
	print(".. save table")
	store_fn = outfn
	with h5py.File(store_fn, 'w') as store:
		## X: n by p np-array
		## Y: n by 1 binary 0/1 np-array
		## rownames: metadata n by 8: exon_id, target, cell, experiment_id i1, s1, i2, s2
		## colnames: sequence feature and exp feature names
		store.create_dataset('X', data = X)
		store.create_dataset('Y', data = Y)
		store.create_dataset('rownames', data = metadata)
		store.create_dataset('colnames', data = np.asarray(colnames, dtype='str').astype('|S30'))

def parser( args ):
	# receive user arguments
	assert len(args.expr)==2
	kallisto_1 = args.expr[0].split(',')
	kallisto_2 = args.expr[1].split(',')
	if args.cis is None:
		cis = os.path.join(os.path.expanduser('~'), '.darts', 'sequenceFeature', 'ENCODE_sequenceFeature_absmax_normalized.h5') 
	else:
		cis = args.cis
	outfn = args.output
	outdir = os.path.dirname(os.path.realpath(outfn))
	darts_flat_fn = args.input
	
	# convert kallisto transcript to gene
	logger.info('convert tx to gene TPM')
	for kal_dir in kallisto_1 + kallisto_2:
		_Darts_kallisto2rsem.parser(kal_dir)
	
	# extract RBP from gene
	logger.info('extract RBP')
	_Darts_rbp.parser(outdir, 
		[os.path.join(x,'gene_tpm.tsv') for x in kallisto_1],
		[os.path.join(x,'gene_tpm.tsv') for x in kallisto_2])
	
	# make the h5 store
	logger.info('make h5 feature table')
	make_single_table(darts_flat_fn, cis, outdir, outfn)


rbp_max_str = """RPS11	9045.929
ERAL1	105.54817
DDX27	128.659
DEK	635.30681
PSMA6	754.036261
TRIM56	31.31385
TRIM71	94.4066
UPF2	41.088399
FARS2	49.00559
ALKBH8	17.197314
ZNF579	74.9148
POLR2B	176.379687
WDR12	62.189647
RPF1	118.32981
MRPS34	248.435
UBTF	132.012302
CDC5L	67.5428
DAZAP1	364.82458
MSI1	279.6727
MSI2	175.64434
TARDBP	279.870376
TRIT1	137.786138
MRPL36	175.742033
KPNB1	407.431205
ZNFX1	139.847369
SNRNP27	187.90356
RBMS2	78.26695
RBMS1	181.06646
RBMS3	88.76099
LARS2	46.14032
KIAA0020	98.40667
RBFOX1	165.304238
RBFOX2	353.357465
CWF19L1	56.48546
CWF19L2	58.36168
ZC3H15	313.6217
LONP1	210.71863
DBR1	21.68673
RRP15	32.0005
L1TD1	349.929
NMD3	167.514163
SRSF12	18.27976
SRSF2	556.058719
RSL1D1	562.452211
DAP3	298.168609
NARS2	83.39161
RBM25	185.565857
POLR2E	556.2207
TOE1	42.0071
TSFM	79.763534
TPR	126.0262
STAU1	277.11446
STAU2	97.062245
TRMT1L	50.94125
METTL3	104.668981
REXO2	256.09265
MRPL52	462.43943
WDR3	100.622
CNOT11	258.3206
METTL2A	26.0813
METTL2B	101.4337
ZNF326	73.12588
AKAP8	69.9788
AKAP8L	140.2238
RPS14	4900.18031
ELAVL1	116.571523
ELAVL2	49.86476
ELAVL3	648.84567
ELAVL4	163.08472
PNN	424.53402
DDX41	161.698762
TNPO2	409.063038
TNPO1	208.11176
PUSL1	60.0069
RBM43	24.8871
ZGPAT	50.464897
SCAF11	205.374227
USP39	132.007
RPL38	6902.114668
NARS	626.290937
RPS16	6608.90622
CLASRP	135.437484
RPS9	3708.589234
TOP3B	207.065438
NCBP2L	1.19199
NCBP2	234.077931
SMG9	74.770681
FTSJ2	70.46995
DDX56	138.41633
RBM28	164.6581
UTP11L	181.3265
RPL14	3351.45054
RPL37	6049.8108
GEMIN5	61.1617
MKRN1	227.100411
MKRN2	84.50399
MKRN3	43.451898
NOA1	33.9323
PINX1	54.99323
HRSP12	358.20341
TDRD9	6.769332
DHX30	124.821829
DHX29	55.49756
DHX57	28.42166
YTHDC2	56.54791
DHX36	64.372845
DHX9	306.531
EIF3G	539.463239
NOL10	74.717776
UTP15	54.89002
GATC	49.95126
TCOF1	123.604921
NONO	623.774564
PSPC1	130.37482
SFPQ	1303.11
NUDT21	233.08625
MRPL19	112.643825
URM1	265.08841
MRPL53	110.9688
RBM48	49.67154
REPIN1	222.356359
ZC3H12B	4.726354
ZC3H12C	30.480036
ZC3H12D	149.18797
ZC3H12A	467.4871
TRMT5	24.7989
TRMT61A	29.717681
PABPN1L	2.705962
PABPN1	679.870604
LSG1	73.40464
EEF1G	3702.7329
RBM33	119.77667
RPP25	142.4566
RPP25L	90.2365
RPP38	44.257373
GARS	574.06314
DRG2	52.204708
TRMU	37.273781
GNL2	300.2481
CPSF2	91.885848
CD3EAP	36.64115
HDLBP	636.081366
RDM1	30.121932
BYSL	90.21643
GEMIN8	33.72142
XPO5	155.336355
ZNF622	140.94
DZIP1	48.740734
DZIP1L	34.41022
GSPT1	392.34815
HBS1L	244.977053
EIF2D	89.610865
METTL1	79.882811
RNASEH1	62.7153
ZNHIT6	62.23016
DARS2	71.189766
SNRPD2	1805.79179
DICER1	81.717148
DYNLL1	914.543461
ZNF638	160.0663
SAMD4B	298.74
SAMD4A	107.7125
RTF1	75.68262
CNOT4	64.683415
TARBP2	67.999789
PRKRA	92.63379
GLE1	52.8387
EXOSC2	92.60592
SSU72	470.5383
GTPBP10	94.02153
RPL10A	6522.92
HENMT1	54.89445
THOC2	207.1853
ENDOG	85.3603
EXOG	31.232696
ASH1L	92.26068
TRMT10C	96.1012
TRMT10A	18.491667
TRMT10B	33.693488
MRPL33	798.83311
SSB	640.914349
LARP7	787.459987
MRPL24	165.426835
RNASEK	857.83373
PELO	52.1778
QARS	302.498501
IPO4	152.99364
CAPRIN1	334.2129
CAPRIN2	84.845772
PNLDC1	4.048139
PARN	56.510435
TIAL1	306.61309
TIA1	321.003481
CDC40	56.76874
ZNF598	199.98321
RCL1	123.036257
RTCA	89.42952
MRPL38	122.46611
ADAT2	46.85
U2SURP	371.96367
DUS3L	72.21232
CSTF3	137.19423
SRSF11	439.92185
SREK1	145.707785
POLR1E	125.260811
EXOSC7	111.993
EXOSC8	123.36426
EXOSC9	137.997292
MRPL12	448.009
RPS28	2249.36
TEFM	27.34992
RPL12	5959.047006
ZC3H3	52.875766
EIF6	393.04552
EIF2B3	177.63395
APOBEC2	511.389
APOBEC3H	10.26358
APOBEC3F	70.94858
APOBEC3G	175.9809
APOBEC1	26.9571
ZC3H7A	100.501432
ZC3H7B	104.4249
NOP9	58.6998
PQBP1	265.16864
PATL2	148.28056
PATL1	109.17
EDC3	76.748076
WBP4	40.27425
GLTSCR2	1086.479833
ASCC1	111.690415
EIF5A	1205.99441
EIF5A2	44.779498
EIF5AL1	7.44279
MRPL47	168.742102
BOLL	2.042515
DAZL	17.398643
DAZ1	0.389832
DAZ2	3.45894
DAZ3	0.297395
DAZ4	3.403141
INTS1	138.514882
RPLP1	7080.43074
MRPS11	113.63473
WDR43	320.32461
TRMT112	420.922056
PPP1R8	105.41686
FBXO17	53.357911
MTHFSD	24.873955
SON	434.19895
SPATS2L	494.786671
SPATS2	62.241409
MAEL	19.31817
RRP1B	66.3726
RRP1	83.8943
ZC3HAV1	151.36086
PARP12	73.493235
TIPARP	397.14297
MRPS17	51.60462
U2AF2	303.3011
UHMK1	100.25386
NUP153	160.7778
CSDE1	1282.158023
POLR2L	782.441
NKRF	32.699457
MRPL48	189.55362
XRCC6	360.924941
SUPT5H	169.602327
TSR3	165.62305
XRN2	194.39977
RSRC1	128.593161
TDRD5	2.312107
POLR2J	475.2712
POLR2J2	178.066
POLR2J3	417.505377
SAFB2	130.8242
SAFB	139.034384
SLTM	182.405333
BRIX1	163.846
POLR2I	219.845245
PWP2	67.07344
ELAC2	107.60136
ZCCHC14	102.51978
ZCCHC2	62.57486
LARS	273.9073
MRPL28	217.623405
CNOT1	254.581136
DDX18	122.88777
TSEN15	331.747
USP10	137.555198
SMNDC1	63.3005
THUMPD2	45.46243
THUMPD3	108.63724
SND1	383.4831
LSM4	301.956158
EIF3M	944.023286
MRPL34	525.869016
SRP72	216.76495
SUGP1	68.059669
SUGP2	141.262098
RPS3	7550.81925
RPS27A	3909.669
CCAR2	253.68419
CCAR1	159.603655
DDX49	112.07592
MRPL4	191.441851
SFSWAP	58.92993
MRPS12	137.9069
EIF1	2213.8171
EIF1B	483.074
CLP1	68.636832
ZMAT5	56.2299
SF3B3	228.438941
PLD6	17.3793
QTRTD1	29.557974
QTRT1	175.83961
PIH1D1	188.077711
SWT1	13.54119
EXOSC4	134.635918
EXOSC6	71.1294
PTRH1	96.314769
INTS8	137.623827
EXOSC10	124.130435
CASC3	124.39612
GTF3A	222.60246
MRPL54	124.746034
GTPBP3	47.429373
UBA1	577.325189
LSM12	130.469261
HINT3	62.873
CCDC59	183.2702
POLDIP3	137.69978
RPL32	6144.623671
AZGP1	1844.08002
C17orf85	52.32802
N4BP1	61.9327
NYNRIN	56.5238
KHNYN	169.80802
NOP2	133.52713
NSUN4	47.11025
NSUN3	19.77336
NSUN6	37.2183
PAN2	55.405592
ZCCHC9	67.84383
RRP9	92.9564
TNRC6A	89.326167
TNRC6B	120.843862
TNRC6C	58.440714
RP9	91.80757
MRPL15	191.581964
NGDN	209.357287
LSM10	213.008
PUS1	55.72125
MAK16	81.3493
RPS13	3604.11105
SNRNP200	227.89955
PRDX1	1435.162311
TSN	107.51748
NUFIP2	209.2502
RBM19	52.24262
TDRKH	31.836715
NOP58	318.4501
RBM6	215.613084
RBM10	96.3809
RBM5	235.37047
RBM44	3.601278
OASL	22.847842
OAS1	223.43348
OAS2	98.776977
OAS3	212.78918
SF3A3	297.392
NOC3L	51.68641
MYEF2	132.194214
HNRNPM	537.465803
C11orf68	191.6263
MRPL10	138.737691
RNASE10	10.7818
CALR	2249.33936
CANX	1107.185042
CALR3	0.911726
RPP14	40.69425
RPS8	6422.6655
PDCD7	30.41549
RPS19BP1	248.0086
TRMT6	147.81544
RPL4	5846.1066
RARS	221.69631
RARS2	114.33163
APOBEC4	2.08336
ZCCHC24	178.4003
RPS21	8656.793031
DDX24	292.92695
RTCB	139.682885
MBNL2	249.717033
MBNL3	793.62309
MBNL1	744.63982
ALYREF	199.963
LSMD1	264.726285
PUS7	106.64989
PUS7L	60.54392
MRPS24	619.78454
RBBP6	183.38644
RPL19	5435.88851
NOL3	94.869063
RPS27	21616.7783
RPS27L	467.0791
PTRF	676.979
MRPS18A	129.64693
SLBP	200.691865
EARS2	40.443279
SMAD1	58.9955
SMAD2	168.8103
SMAD5	91.82758
SMAD9	17.52906
SMAD3	183.436771
SMAD4	125.96302
SMAD7	79.892153
SMAD6	87.744263
PRPF39	68.06459
SRP68	170.4083
ADARB2	8.634128
ADAD1	0.327323
ADAD2	23.886842
ADAT1	120.21241
ADARB1	66.390226
ADAR	144.077539
CLK3	267.741311
CLK4	68.30741
PRPF4B	108.4263
CLK1	728.5648
CLK2	70.78839
LSM3	73.0138
FAM46A	189.17323
CRYZ	241.37173
KIN	23.162946
RPS2	6951.637768
DUS4L	34.760519
EIF4A1	1670.423017
EIF4A2	1041.015765
EIF4A3	328.8245
IGF2BP1	166.5926
IGF2BP2	180.9878
IGF2BP3	110.998024
UBAP2	102.733275
UBAP2L	332.149193
SNRPE	617.582
EIF2B5	94.58305
CRNKL1	47.281084
POLRMT	79.631948
METTL10	49.76667
MRPL41	224.458
MRPS7	147.291009
NSUN5	136.534472
NSUN7	16.05718
MTG1	5.52265
MRPS28	275.565682
TDRD10	11.58095
RPUSD1	90.54107
NHP2	319.85688
XAB2	95.69153
FAU	1892.099659
RRP36	146.18627
GRWD1	90.537
ENDOV	56.230482
MRRF	81.11585
MTFMT	20.32285
C12orf65	91.92336
MRTO4	156.875
RBM26	112.14679
RBM27	59.9706
DIS3	68.29395
DIS3L	55.607948
DIS3L2	65.04707
C1QBP	647.45506
SUB1	829.923362
MRPS33	191.099341
PRPF6	142.63022
SMG8	57.77795
PSTK	23.49237
GAPDH	14564.4598
TNPO3	140.0984
IPO13	78.46727
MOV10	87.60929
MOV10L1	9.677744
PARP1	305.49954
MRPS35	117.96526
SETD1A	54.5486
SETD1B	106.274067
SF3A2	271.745597
AFF1	545.66641
AFF3	221.23083
AFF4	205.0178
PARK7	529.89362
TRNAU1AP	45.2889
SRBD1	28.112
EIF3D	434.816915
NOP10	533.943168
WARS	750.288946
MATR3	616.541892
SNRPD1	466.813
SNRPC	634.95592
FXR1	665.188981
FXR2	134.043374
FMR1	107.376826
MEPCE	80.5717
KAT8	93.61962
CIRBP	905.490533
RBM3	354.8021
CNOT7	304.440055
CNOT8	153.693089
A1CF	79.616284
RBM46	0.84601
RBM47	162.644861
DND1	15.7218
HNRNPR	504.23894
SYNCRIP	393.3558
ABCE1	288.58668
GPATCH4	158.3272
PAIP1	198.247205
RBM20	23.4249
GNL3	311.162289
GNL3L	70.8875
FAM120A	202.18025
FAM120B	36.26564
FAM120C	24.78034
KHDC1	14.42073
KHDC1L	0.789618
RPL10L	1.5244
RPL10	11353.859494
EIF2S1	140.17277
MRPL20	292.7984
EPRS	449.15486
DDX58	52.99767
IFIH1	37.45052
CDK5RAP1	73.87244
HABP4	91.3536
SERBP1	592.8445
METTL5	301.411117
ZCCHC7	238.01956
WDR36	85.44745
CCDC86	153.01196
C2orf15	77.82861
MRPL30	127.38757
RPS26	7487.05624
TEX13A	0.629773
BARD1	45.484993
XPO4	26.88943
RUVBL1	138.998342
IMP4	176.532343
DDX52	57.235754
THOC1	148.97789
TRPT1	86.205554
NHP2L1	370.3575
EIF2B2	130.81961
RNF113B	6.22068
RNF113A	46.266
INTS10	108.880247
RPS29	19869.5554
NOP16	156.18546
U2AF1	481.80407
U2AF1L4	85.326997
RANBP6	41.4734
IPO5	306.069201
THOC7	139.821627
DNMT3B	699.4409
GFM1	82.8804
RNASE9	0.124359
PLRG1	147.651501
REXO1	62.1355
ZC3HAV1L	30.3096
LSM14B	156.561641
TDRD6	23.962238
TDRD15	1.67869
MRPS22	207.33632
EEF1B2	2476.74342
EEF1D	1339.091239
SIDT1	32.7655
SIDT2	71.9114
TRMT44	19.61352
GPATCH8	93.075224
WDR4	60.7887
SLIRP	1314.711094
ATXN1	36.25936
ATXN1L	38.2229
YTHDF1	98.24461
YTHDF2	179.3579
YTHDF3	76.463094
LRPPRC	217.34374
TFIP11	92.42477
ILF2	947.94991
STRBP	157.58006
ILF3	463.772923
TCERG1	123.6481
NXF5	0.899708
NXF2B	32.171502
NXF1	486.949092
NXF3	5.24512
ZRSR1	14.7901
ZRSR2	52.089
MRPL35	192.94076
RRS1	54.1592
PRKDC	206.580775
NOC2L	266.574
MTIF3	104.27867
NOL11	156.76103
EXOSC3	89.1955
PNPT1	92.19151
TSNAX	87.0097
RIOK1	100.1242
RIOK3	140.76198
PIWIL1	0.503856
PIWIL2	7.218622
PIWIL3	1.225131
PIWIL4	17.530866
PEG10	3745.42
ZCCHC5	2.72903
POP7	125.5657
FASTKD3	33.161634
TBRG4	154.413148
FASTK	170.2788
TRMT13	45.32106
IREB2	79.698813
ACO1	106.51776
ZCCHC3	70.85
SNUPN	47.557887
PTRHD1	49.8596
HARS	96.893236
HARS2	61.957746
HNRNPK	776.4266
PCBP1	589.797
PCBP2	1064.421506
PCBP3	23.382091
PCBP4	322.57381
AQR	51.4943
ICT1	116.222
UNK	86.859696
UNKL	50.206521
CEBPZ	117.178835
MRPS9	97.274692
THG1L	45.367687
ZCCHC13	0.069931
CNBP	545.771295
SRRT	281.063788
CD2BP2	88.6764
SNRPG	904.62726
APTX	64.796118
RPL17	6003.530876
BMS1	63.8692
SARS	592.7194
SARS2	3.52258
PAIP2	259.848579
PAIP2B	31.5913
GEMIN4	63.697062
PNRC2	355.514278
FASTKD2	55.67245
GEMIN6	70.82959
DDX20	33.9069
DDX39A	405.499044
DHX37	46.94959
ZNF346	48.496518
MRPL50	108.0228
RNASE1	1381.83869
RNASE2	92.2727
RNASE3	23.2745
RNASE4	424.052
RNASE6	278.553
RNASE7	326.9942
RNASE8	1.47721
ANG	1156.132
DYNC1H1	282.8229
FTSJ3	87.085259
SF3B2	317.872532
CTU2	53.505586
XPOT	307.9651
RBMXL1	21.8091
RBMXL2	0.540873
RBMXL3	0.983127
RBMY1A1	1.119233
RBMY1B	0.055354
RBMY1D	0.310984
RBMY1E	0.1681
RBMY1F	0.062464
RBMY1J	0.294899
RBMX	728.5618
DKC1	443.61035
MRPL17	114.7141
TRA2A	176.71456
TRA2B	464.55691
RPL26L1	137.92022
RPL26	10242.721321
AUH	55.76517
EIF3C	776.841771
EIF3CL	131.57686
SCAF8	64.60383
SCAF4	120.4035
EEF2K	44.10754
RPL6	3334.201488
MRPL11	157.597145
G3BP1	295.433835
G3BP2	244.445363
MRPS26	126.213
SF3B5	343.678
DHX34	68.4221
UTP23	43.749699
SNRNP48	54.1067
PRPF38B	118.3442
HEXIM1	115.341
HEXIM2	65.336852
SRRM2	1028.146298
PIH1D3	3.22133
DHX40	76.467868
DHX38	75.594933
TRMT61B	33.589328
CSDC2	366.11568
CARHSP1	447.892172
POP4	115.30758
LARP6	217.2722
RNPC3	82.93166
RPL30	8780.60586
RUVBL2	303.026241
DRG1	131.86299
TRIM25	134.65936
RQCD1	94.12254
MRPS18C	199.56756
MRPL45	145.39052
RPLP2	4974.7051
SRP19	207.90166
RPS24	11991.65888
AKAP17A	61.0617
NXT2	20.179095
NXT1	99.657
MRPL9	102.2014
RPL27	5067.45074
RPL24	3790.11134
CNOT10	122.47766
ABT1	58.3478
DDX25	36.27433
DDX19A	99.657903
DDX19B	17.8327
MRPS30	110.904
SMG1	739.05558
EXOSC5	75.65657
AIMP2	143.58317
BZW2	611.099771
BZW1	379.39136
PARS2	15.6873
INTS12	61.640447
EIF3H	632.116954
RC3H2	73.012435
RC3H1	37.995727
ZFP36	2845.5003
ZFP36L1	1338.078784
ZFP36L2	1273.51
ANKHD1	337.55278
ANKRD17	80.5465
HELZ2	60.6872
UPF1	81.0983
DROSHA	135.826089
MRPL37	291.50307
PUS10	46.927339
NUDT16	73.314761
NUDT16L1	61.643047
TRMT11	112.140418
PET112	51.98211
NUFIP1	22.8277
PURA	31.2267
PURB	30.8893
PURG	22.31541
ZRANB2	207.0381
THOC5	75.890295
TSEN54	98.97943
SRP9	762.083
PIN4	88.798382
ZC3H14	91.959669
CNOT2	259.626924
TARBP1	72.948
AGO1	54.4118
AGO2	74.09311
AGO3	49.99594
AGO4	52.064
LARP4B	106.83284
LARP4	100.983669
SNW1	125.04237
EZH2	190.63997
EIF3B	341.00727
RPP30	57.88885
ZMAT3	72.44615
PTGES3	754.413221
KARS	417.666452
RAN	1449.258452
SNRPA	262.976603
SNRPB2	177.9098
HEATR1	115.39098
PTGES3L-AARSD1	12.438764
AARSD1	86.922265
CPSF3	99.03342
CPSF3L	369.062626
CWC25	82.43967
RPS5	3543.164943
POLR2D	92.89582
C9orf114	54.6458
MRPL44	87.2554
ETF1	376.60282
GAR1	173.9916
MVP	305.737434
RPF2	278.06891
ZC3H18	85.11981
INTS5	41.0935
INTS3	120.35491
LSM6	115.9027
SNRPF	151.56221
TUT1	38.476332
MTPAP	43.9181
EIF2AK1	248.666229
EIF2AK2	73.37323
EIF2AK3	87.3405
EIF2AK4	92.89401
MRPL22	146.54562
PES1	126.107323
LSM7	396.93611
PAPD4	87.304666
ZCCHC11	140.117882
ZCCHC6	114.95214
KHDRBS1	220.016988
KHDRBS2	27.0737
KHDRBS3	202.258585
QKI	1066.72627
SF1	569.95822
LRRC47	100.183518
ISY1	51.196558
SRRM1	411.08961
IPO9	114.9728
MTRF1	39.03453
MTRF1L	51.91767
WIBG	72.02669
PPAN	132.645573
FUBP3	90.8671
FUBP1	286.7697
KHSRP	657.682492
CHTOP	150.25178
PTCD2	30.423647
POLR2A	320.461939
MRPL43	174.56333
DDX55	116.91095
RPS15	5533.975332
CPSF4	111.53753
CPSF4L	4.4206
CSTF2	52.951738
CSTF2T	35.2479
RAVER2	38.798056
RAVER1	137.940039
EIF1AX	213.0152
EIF1AY	103.243
DALRD3	104.40028
NSUN2	168.152402
URB2	35.83955
PHAX	25.8294
PPARGC1A	48.300936
PPARGC1B	14.464204
PPRC1	232.5521
PHF5A	115.268
MCTS1	195.25314
RRP7A	105.9465
DGCR8	75.890376
ZC3H13	61.18846
UPF3A	98.9885
UPF3B	86.6962
RBM24	187.22841
RBM38	579.17134
THOC3	238.915603
IGHMBP2	22.574337
PAPD5	28.911151
PAPD7	55.95106
GFM2	63.561866
PHRF1	55.06636
VARS2	75.450832
MRPL1	88.21599
INTS7	46.68478
ATXN2L	353.884075
ATXN2	129.062253
PPIL4	168.182886
PPIL3	145.0029
PPWD1	100.91059
CWC27	78.938212
PPIH	357.83909
NUTF2	277.552186
MRPL18	244.735
LSM11	21.318
AARS2	23.1323
AARS	475.6277
MIF4GD	71.251673
CTIF	108.4234
C9orf129	11.9517
LUC7L2	70.2687
LUC7L3	534.814921
LUC7L	257.09604
DUS2	67.122045
RNF17	6.270618
TDRD1	2.050928
MRPS10	138.892
FAM103A1	60.4474
ENOX1	32.12598
ENOX2	26.9522
RBPMS	485.46645
RBPMS2	356.64
NIP7	98.21976
RPL3	6457.1068
RPL3L	240.709357
RNASE11	0.621275
RNASE12	0.556155
RPLP0	6720.289137
RBM34	116.705009
CMTR2	42.696072
ENDOU	130.24045
PUM1	208.489677
PUM2	125.340241
TYW5	21.11957
TYW3	70.388884
TRMT1	98.76648
RAE1	163.401365
SLU7	67.6575
EIF2B4	118.593857
EIF5B	130.212
GPATCH1	13.14627
RPL36	2502.92043
EEF1A1	24346.29834
EEF1A2	1463.901
RRP8	61.4686
UBA52	3362.230275
R3HDM1	213.13779
R3HDM2	196.34713
PA2G4	993.49582
AAR2	67.72783
ERI1	54.915704
ERI2	44.387627
ERI3	167.58988
NIFK	228.50409
METTL14	27.972999
MRPL32	169.24636
CPSF6	187.69676
CPSF7	203.463949
WDR46	101.56418
SRP14	865.12217
TFAM	236.4363
CMSS1	181.191567
XPO6	355.41757
EXOSC1	81.926763
ZNF106	507.60322
UTP14A	93.683721
UTP14C	19.8455
TRUB1	53.263
TRUB2	101.44955
PRIM1	166.73909
PTCD3	127.43873
HNRNPA0	179.905
HNRNPA1	5355.39426
HNRNPA1L2	28.09971
HNRNPA2B1	1846.5732
HNRNPA3	920.686
HNRNPAB	361.039547
HNRNPD	1253.811852
HNRNPDL	604.619
RANBP2	100.633
RPL7	5457.750696
RPL7L1	224.3131
RNASE13	4.44932
RPS6	6227.5259
MRPL3	217.68013
DDX28	16.1608
DDX47	202.03192
RNASEH2C	194.91708
TFB2M	71.38978
TEP1	71.111211
NOC4L	76.960312
CPSF1	158.5066
DDX1	230.97353
DDX3X	744.936748
DDX3Y	215.7437
DDX4	0.722123
NOP56	508.84878
RPS20	5346.98172
MPHOSPH10	191.6727
MRM1	31.1498
DENR	118.3902
RPL21	6328.51299
RPS10	6121.07737
NAT10	98.284686
UTP18	114.226668
NOL12	49.24382
DDX31	25.104229
DNMT1	216.629795
SNRPA1	263.57705
API5	141.566058
SHQ1	30.18635
AKAP1	186.48545
FTO	111.705391
PUF60	398.759581
SAMHD1	509.7981
RBM45	24.11586
FAM98B	66.81501
FAM98A	125.109654
FAM98C	30.185654
PCF11	413.02608
EIF5	512.499959
ZC3HC1	85.339288
HNRNPC	1497.109589
HNRNPCL1	3.02596
RALY	311.926919
RALYL	60.85539
SEPSECS	38.167242
NPM1	3671.63455
NPM3	170.24
NPM2	77.310225
NUPL2	61.04559
MRPS14	58.432
SF3A1	237.982347
EIF3A	250.536
FASTKD5	69.8388
TDRD3	68.569876
SNRPB	529.5657
SNRPN	294.480662
YRDC	106.471
POLR2K	220.1427
ERN2	107.84062
ERN1	83.1415
RPL5	4008.5948
RPS17	5151.53498
RPS17L	4654.455344
DARS	263.473691
IPO7	201.128927
IPO8	85.169418
SMN1	241.9075
SMN2	95.842421
GTPBP4	173.720428
MRPL13	140.005211
MRPL46	166.473167
LSM5	264.80455
EIF4G3	193.199251
EIF4G1	492.766132
EIF4G2	1213.545253
GTF2F1	118.34651
RPS15A	8905.040605
TTF2	40.428
PUS3	35.59
RBM7	124.73912
RBM11	11.947
TSEN2	62.15305
RBM42	160.503509
UTP3	84.1749
HNRNPL	504.04708
HNRNPLL	185.296922
PTBP1	777.81625
PTBP2	142.97532
PTBP3	209.32742
SYMPK	117.14498
POLR2F	250.353417
TSR2	70.6049
KIAA0391	90.106934
POLR2G	221.671181
WDR5	53.235419
SNRNP40	169.59659
WDR83	35.484461
ZFC3H1	99.43972
RPL15	4703.277214
SNRNP35	40.30119
SNRNP70	411.72007
MRPL39	123.2667
TLR7	22.591
TLR8	134.4813
TLR3	57.1417
NAA38	431.52979
PRPF31	103.567644
MRPL55	99.294522
TRMT2A	109.051363
TRMT2B	46.657934
RPS3A	7933.360425
BRCA1	92.39141
RIOK2	83.363736
DHX33	41.375963
DHX35	29.070177
DHX32	88.644789
DQX1	94.4009
DHX15	249.698
DHX8	88.03047
MRPS5	165.85639
SAP18	461.91538
TUFM	313.08814
EEFSEC	51.55888
TDRD12	6.905772
SKIV2L2	158.23123
TRDMT1	19.07317
ZNF473	93.688049
FCF1	85.490663
URB1	60.0054
CARS	142.533318
CARS2	101.018246
CELF1	154.76279
CELF2	235.889503
CELF3	696.79735
CELF4	117.991402
CELF5	411.793
CELF6	38.68815
XPO1	531.052755
DDX17	758.1211
DDX46	127.88263
DDX42	147.318146
DDX43	8.180863
DDX53	4.91094
FIP1L1	206.987676
MRPL14	257.471
TXNL4A	170.575629
TXNL4B	74.300008
RBM39	1501.065632
RBM23	174.971122
CPEB1	24.455116
CPEB2	57.967566
CPEB3	9.92195
CPEB4	138.02189
INTS9	45.594668
CACTIN	41.327111
MPHOSPH6	131.28699
RPL34	9870.18675
OBFC1	79.5138
RPS12	10669.6
PRPF8	201.342853
SECISBP2L	169.3314
SECISBP2	101.3679
RPUSD3	129.021656
RPUSD4	112.31671
RPL28	8899.32709
ELAC1	16.93544
NOM1	37.2919
TROVE2	214.183745
EEF1E1	488.5157
TARSL2	31.63988
TARS	627.14731
TARS2	49.497772
IARS	568.61531
RPL18A	5933.21695
ESF1	73.4768
EEF2	3696.84
EFTUD2	214.77373
DDX60	54.59966
DDX60L	125.169028
MRPL2	179.54911
SLC4A1AP	51.76638
MAZ	917.512487
EIF2S3L	2.98817
EIF2S3	611.92358
AIMP1	144.879605
APEX1	436.270029
EIF3J	450.68024
PABPC3	0.849077
PABPC1L	429.724806
PABPC4L	12.72904
PABPC5	11.21723
PABPC4	363.53281
PABPC1	4410.236254
MEX3A	115.881
MEX3B	91.9314
MEX3C	93.9174
MEX3D	80.5099
GEMIN7	63.51274
MRPS23	252.28736
PSIP1	300.4134
SRP54	214.832805
FARSB	155.1027
SPEN	142.890368
RBM15B	68.3142
RBM15	61.5539
DNAAF2	20.69721
SF3B1	715.79638
RNASEH2B	196.7113
FARSA	328.673165
NOB1	183.8213
EIF2A	371.652494
RNASEL	24.48389
TRNT1	141.978515
EIF4ENIF1	93.944978
MECP2	139.225548
RBM22	107.04658
CMTR1	76.855565
RPL39	12481.7
RPL39L	1342.597363
RPSA	2862.01666
PARP4	70.1312
CSTF1	81.276775
NCBP1	69.9044
SNRNP25	122.61476
DNAJC21	87.57615
CWC22	62.49757
NFX1	69.13553
MRPS31	47.8333
SMG5	89.890616
SART1	64.97674
GEMIN2	97.255779
NR0B1	122.8027
DCP2	186.73075
TAF15	316.20181
EWSR1	527.318944
FUS	589.2831
EDC4	100.21759
FBLL1	101.702
FBL	791.0643
MRPS27	121.481473
ALKBH1	18.42655
ZCCHC17	98.65335
MRPL49	110.312518
RPL18	5460.60859
RPS4X	4955.27
RPS4Y1	677.641
RPS4Y2	3.82693
NOP14	108.288902
KRR1	80.5037
NCL	1439.86277
PRPF18	48.9892
C1D	143.74522
ADAT3	60.992112
UTP20	40.8086
SNIP1	53.2285
GUF1	43.89441
GCFC2	54.107106
UTP6	114.0388
SRSF1	510.95528
SRSF3	1186.7148
SRSF4	174.80813
SRSF5	1336.15658
SRSF6	354.453
SRSF7	747.819191
SRSF9	282.33102
USB1	135.835959
NOL6	98.303668
PPIE	169.679358
RRBP1	579.620206
SUZ12	82.58463
TERT	9.972409
MSL3	149.615287
BICC1	71.62877
MRPS16	128.11792
RBMX2	73.14711
MRPL40	133.329
ISG20	332.227
ISG20L2	69.7596
AEN	155.67644
REXO4	66.3231
TGS1	40.2127
ZC3H4	45.08199
ZC3H6	15.670416
ZC3H8	67.54083
RPL27A	5653.24596
RPS19	4728.48493
SYF2	126.80279
TFB1M	105.47
DIMT1	92.8732
TSEN34	132.077143
DCAF13	198.93398
RPL9	7764.436175
ARHGEF28	82.359738
AC004381.6	101.684137
EIF4B	994.0723
DDX54	128.49411
MRPS36	85.128108
PRPF40A	242.556466
PRPF40B	39.99886
EIF3L	1293.82218
NOL8	95.789614
MTO1	77.005085
PSMA1	472.36847
HTATSF1	94.09001
LAS1L	102.915476
POP1	30.28774
DZIP3	49.00573
DGCR14	78.5988
CDK9	76.315441
PAN3	69.3251
RPL29	5956.532474
DCPS	53.8322
MRP63	38.8101
MRPL27	361.278606
POLR2H	175.175299
ZNF239	30.50731
XRN1	94.492033
ZFR	123.4976
ZFR2	51.084652
AGFG1	190.570764
NSA2	218.00446
DDX10	56.16029
TBL3	143.3541
INTS2	28.630515
YBX1	2219.9689
YBX2	50.313916
YBX3	3321.8348
THOC6	155.05613
EIF3I	655.74278
STRAP	219.983529
RPL13	8365.922719
RRP12	159.81999
MRPS2	227.61186
ZCCHC8	65.978496
EFTUD1	47.360957
RPL35	6190.7868
NSRP1	150.485518
RPUSD2	27.5452
BCDIN3D	14.8911
THUMPD1	87.92854
TRIM21	74.80112
RANBP17	29.799051
XPO7	155.691126
TRMT12	26.5214
ACIN1	278.055147
ZNF385A	206.216382
RPL23	6301.92556
EED	68.481662
DNTTIP2	308.1513
SBDS	787.962
DDX51	34.5314
RBM18	25.073
IPO11	89.199524
RPL22	2849.62733
RPL22L1	696.527421
LCMT2	20.818946
ZC3H11A	189.14219
FYTTD1	146.990085
RNPS1	347.018306
RPS23	7723.828
RNASEH2A	107.224
FRG1B	286.1129
NOL7	232.05335
PRPF38A	72.9941
RBM41	96.33639
RBM12	177.995645
RBM12B	67.450066
ESRP1	115.57696
ESRP2	67.64292
HNRNPF	385.45225
HNRNPH1	2092.04542
HNRNPH2	127.636
HNRNPH3	500.3715
GRSF1	130.481328
RNH1	526.097494
NOL9	60.7822
SRFBP1	28.3592
ARL6IP4	334.422444
RPP40	64.5676
ALKBH5	194.92188
SMG7	113.631789
PDE12	34.6678
CCRN4L	182.45
ANGEL1	38.42598
ANGEL2	35.25821
CNOT6	40.69668
CNOT6L	321.33318
PDCD11	73.3767
RPL35A	3629.06975
MRPL21	250.31206
SMG6	61.836989
PRPF19	221.479152
PRPF4	60.2191
INTS4	55.83166
SRPK2	100.599548
SUPV3L1	81.863106
RBM17	200.47843
NAF1	108.5812
YARS	336.42
LRRFIP1	237.41352
LRRFIP2	544.523466
EIF4E2	174.570239
EIF4E1B	1.400996
EIF4E3	62.42897
EIF4E	422.28773
BUD13	38.34683
CTU1	24.9346
GTPBP1	161.43492
GTPBP2	344.67112
MTERFD2	144.63671
SRPR	500.5161
DDX50	122.66901
DDX21	399.031
ZCRB1	192.37526
RPL13A	6995.776
SRA1	42.54274
PAPOLB	0.682275
PAPOLG	32.68898
PAPOLA	292.402197
RPL41	26080.218
ZNF768	99.8451
SCAF1	123.406086
MRPS15	202.926
RNASET2	767.012825
EIF2B1	109.05462
RPL36AL	827.43
DDX26B	34.9917
INTS6	147.908599
RPS7	4234.31877
RRNAD1	63.765829
MRPS21	172.8307
SETD7	107.120006
RBM8A	397.1395
MAGOH	339.417
MAGOHB	102.819161
RPL37A	13748.527383
NOLC1	407.04813
IARS2	129.3695
LSM1	87.35622
SUPT4H1	268.95704
EXO1	154.591269
DCP1B	46.127562
DCP1A	153.6309
DNAJC17	34.881604
RNGTT	49.25369
DUSP11	58.77895
CHERP	95.7646
WDR61	167.07985
NANOS1	40.7507
NANOS2	0.49831
NANOS3	31.69977
EBNA1BP2	253.03251
HELZ	129.82816
RNMTL1	29.583314
PDCD4	365.991
PTRH2	146.205456
SART3	74.536144
ZC3H10	15.250687
MRPS25	157.570805
ZMAT2	172.13064
IFIT1	62.40254
IFIT2	39.9619
IFIT5	46.6437
IFIT1B	1.77677
IFIT3	51.9827
NOVA1	239.799587
NOVA2	140.3028
SNRPD3	383.3364
YARS2	43.6147
PTCD1	31.229636
TSR1	70.78264
MRPS6	285.893
TAF9	396.21429
RPL11	6460.2295
DDX23	147.322982
DDX59	53.65882
CCNT2	66.39818
CCNT1	65.9235
RPL8	4151.02377
SARNP	204.517469
IMP3	107.6469
SRRM4	67.6183
CNP	340.02266
LIN28A	757.658
LIN28B	83.0048
EIF3K	879.560721
SF3B14	439.563
EIF2S2	301.339
RNMT	75.219566
MRPL42	193.75216
THRAP3	131.1268
BCLAF1	238.58399
CXorf23	26.301986
PNO1	100.6139
RBM4	277.473424
RBM4B	95.69093
RBM14	117.954094
R3HCC1	78.130654
R3HCC1L	29.6997
KIAA0430	91.038252
POP5	65.72292
MRPL51	621.79
MARS	441.66754
TYW1	35.607546
MRPL16	207.4672
DUS1L	186.49529
QRSL1	58.1903
WARS2	26.72733
WRAP53	35.832348
RSL24D1	405.6031
SF3B4	262.557458
TDRD7	44.11894
LARP1	324.560062
LARP1B	78.381977
RPL23A	5349.640826
BAZ2A	240.041968
BAZ2B	147.08102
EIF3E	1498.04086
TOP1	179.735
RPL31	11640.056175
SUPT6H	137.50066
TST	343.1236
HNRNPU	507.0733
HNRNPUL1	363.714401
HNRNPUL2	70.5496
RPS25	5717.22811
MRPL23	276.643659
EIF1AD	151.628311
SETX	104.419807
MARS2	15.8497
CNOT3	133.92654
MTIF2	141.600896
JAKMIP1	55.579308
FASTKD1	106.17929"""